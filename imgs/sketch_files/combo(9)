YUI.add("person-relationship-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[],i={};if(e.Lang.isObject(n,!0)){i.user_id=t,i.friend=this.getValue(t,"isFriend"),i.family=this.getValue(t,"isFamily"),"isContact"in n&&(n.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(i,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(i,this.appContext)));if("isFriend"in n||"isFamily"in n)"isFriend"in n&&(i.friend=n.isFriend.newVal),"isFamily"in n&&(i.family=n.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(i,this.appContext))}return e.Promise.all(r)}},toggleFollowing:function(e){var t=this.getValue(e,"isContact");t?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){var t=this.getValue(e,"isFriend");t?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){var t=this.getValue(e,"isFamily");t?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var n=this.appContext.getViewer();return!!n&&this.getValue(t,"nsid")===n.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","attribute-helpers"]});
YUI.add("flickr-prefs-setSafeSearch-updater",function(e){"use strict";function t(e,t){return t.callAPI("flickr.prefs.setSafeSearch",e).then(null,function(e){throw t[e.fatal?"error":"debug"]("[flickr-prefs-setSafeSearch-updater] failed getting or processing API response:",e),e})}e.namespace("ModelUpdaters")["flickr-prefs-setSafeSearch"]={run:t}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("person-preferences-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[],i={};return e.Lang.isObject(n,!0)&&"safeSearch"in n&&(i.safe_search=e.AttributeHelpers.coerceInteger(n.safeSearch.newVal)+1,r.push(e.ModelUpdaters["flickr-prefs-setSafeSearch"].run(i,this.appContext))),e.Promise.all(r)}},attributes:{safeSearch:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-prefs-setSafeSearch-updater","attribute-helpers"]});
YUI.add("person-profile-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)}},attributes:{nsid:{readOnly:!0,defaultFn:function(e){return e}},photoCount:{},unreadMessages:{},storageUsed:{},storageTotal:{},coverPhotoUrls:{},location:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher"]});
YUI.add("flickr-groups-join-creator",function(e){"use strict";function t(t,n){var r={};return r.group_id=t.groupModel.id,r.accept_rules=t.acceptRules,e.Promise.all([n.callAPI("flickr.groups.join",r)]).then(function(e){var n=e[0];if(n.stat==="ok")return t.groupModel.join(),t.groupModel},function(e){throw n[e.fatal?"error":"debug"]("[flickr-groups-join] failed getting or processing API response:",e),e})}e.namespace("ModelCreators")["flickr-groups-join"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-groups-leave-deletor",function(e){"use strict";function t(t,n){var r={};return r.group_id=t.groupModel.id,r.delete_photos=t.deletePhotos,e.Promise.all([n.callAPI("flickr.groups.leave",r)]).then(function(e){var n=e[0];if(n.stat==="ok")return t.groupModel.leave(),t.groupModel},function(e){throw n[e.fatal?"error":"debug"]("[flickr-groups-leave] failed getting or processing API response:",e),e})}e.namespace("ModelDeletors")["flickr-groups-leave"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("group-info-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-groups-getInfo"].run(t,this.appContext)},join:function(t,n){return e.ModelCreators["flickr-groups-join"].run(t,n)},leave:function(t,n){return e.ModelDeletors["flickr-groups-leave"].run(t,n)}},join:function(e){var t=this.getValue(e,"group");return t&&t.setValue("isMember",!0),this},leave:function(e){var t=this.getValue(e,"group");return t&&(t.setValue("isAdmin",!1),t.setValue("isModerator",!1),t.setValue("isMember",!1),this.setValue(e,"hasPendingInvite",!1)),this},attributes:{pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},description:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},secureDescription:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},rules:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},secureRules:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},hasPendingInvite:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},discussionsLocked:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},privacy:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:1},restrictions:{},throttle:{},poolPreviewRowsVisibleCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 1}},coverPhotoAttribution:{},group:{isModel:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-groups-getInfo-fetcher","flickr-groups-join-creator","flickr-groups-leave-deletor","attribute-helpers","group-models"]});
YUI.add("flickr-groups-getInfo-fetcher",function(e){"use strict";function t(t){var n={extras:e.APIHelper.request.getRebootPhotoExtras()+","+e.APIHelper.request.getRebootGroupExtras()+", blast_user_info, date_last_viewed, has_pending_invite, coverphoto_attribution, is_locked",secure_image_embeds:1,lang:undefined};if(t.id)n.group_id=t.id;else{if(!t.pathAlias)throw new Error("[flickr-groups-getInfo-fetcher] `id` or `pathAlias` is required.");n.group_path_alias=t.pathAlias}return n}function n(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a,f,l,c;return l=s.parseGroupModel(n.id,n.pathAlias,r.group),s.exists(l.id)||s.add(l),f={id:l.id,viewedPool:e.moment(r.group.viewedDates?r.group.viewedDates.pool:undefined),viewedDiscussions:e.moment(r.group.viewedDates?r.group.viewedDates.discussions:undefined),group:s.proxy(l.id)},u.exists(f.id)||u.add(f),l=s.proxy(l.id),c={id:l.id,blastMessage:r.group.blast?r.group.blast.content:"",blastMessageSecure:r.group.blast?r.group.secureBlast.content:"",blastUserId:r.group.blast?r.group.blast.userId:"",blastDateAdded:r.group.blast?e.moment(r.group.blast.dateBlastAdded,"X"):e.moment(),blastUserName:r.group.blast?r.group.blast.userName:"",blastPathAlias:r.group.blast?r.group.blast.userPathAlias:"",blastRealName:r.group.blast?r.group.blast.realName:"",blastUserStatus:r.group.blast?r.group.blast.userStatus:""},o.exists(l.id)||o.add(c),a={id:r.group.id,pathAlias:r.group.pathAlias||n.pathAlias,description:r.group.description.content,secureDescription:r.group.secureDescription?r.group.secureDescription.content:"",rules:r.group.rules.content,secureRules:r.group.secureRules.content,restrictions:r.group.restrictions,throttle:r.group.throttle,poolPreviewRowsVisibleCount:r.group.pool_rows,group:l,discussionsLocked:r.group.isLocked==="1",hasPendingInvite:r.group.has_pending_invite,coverPhotoAttribution:r.group.coverphoto},i.exists(a.id)||i.add(a),i.proxy(a.id)}function r(t,n){var r=this;return e.Promise.all([n.callAPI("flickr.groups.getInfo",this._processParams(t),!0),n.getModelRegistry("group-info-models"),n.getModelRegistry("group-models"),n.getModelRegistry("group-blast-models"),n.getModelRegistry("group-activity-models")]).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-groups-getInfo-fetcher] failed getting or processing API response:",e),e})}e.namespace("ModelFetchers")["flickr-groups-getInfo"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["group-info-models","group-models"]});
YUI.add("group-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,parseGroupModel:function(t,n,r){var i={id:r.id||t||r.nsid,pathAlias:r.pathAlias||n||r.pathalias,title:r.title,invitationOnly:r.invitationOnly,memberCount:r.memberCount,poolCount:r.photos,poolPreviewRowsVisibleCount:r.pool_rows,topicCount:r.topicCount==="string"?r.topicCount:undefined,pendingCount:r.pool_pending_count,memberPendingCount:r.member_pending_count,iconurls:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(r.iconurls),isMember:r.is_member||r.member||r.isMember,isModerator:r.is_moderator||r.moderator||r.isModerator,isAdmin:r.is_admin||r.admin||r.isAdmin,eighteenplus:r.eighteenplus,coverPhotoUrls:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(r.coverphotoUrl),latestPhotoActivity:e.moment(e.moment(r.date_activity_detail?r.date_activity_detail.pool:undefined,"X")._d),latestDiscussionActivity:e.moment(e.moment(r.date_activity_detail?r.date_activity_detail.discussions:undefined,"X")._d),showPoolToNonMembers:r.show_pool,showDiscussionToNonMembers:r.show_discussion,needsInterstitial:r.needs_interstitial},s;return typeof r.datecreate=="string"?s=r.datecreate:r.datecreate&&typeof r.datecreate.content=="string"&&(s=r.datecreate.content),s?(s+=" +0700",i.dateCreated=e.moment(s,"YYYY-MM-DD HH:mm:ss Z")):i.dateCreated=new e.moment,!i.title&&r.name&&(i.title=typeof r.name=="string"?r.name:r.name.content),!i.memberCount&&r.members&&(i.memberCount=typeof r.members!="string"?r.members.content:r.members),!i.poolCount&&r.poolCount&&(i.poolCount=typeof r.poolCount!="string"?r.poolCount.content:r.poolCount),i.topicCount||(r.topicCount?i.topicCount=typeof r.topicCount!="string"?r.topicCount.content:r.topicCount:i.topicCount=0),r.privacy&&(parseInt(r.privacy,10)?i.privacy=parseInt(r.privacy,10):r.privacy.content&&(i.privacy=r.privacy.content)),i},attributes:{title:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||undefined},defaultFn:function(e){return e}},isModerator:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},invitationOnly:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMember:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isAdmin:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},memberCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},poolCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},friendlyPoolCount:{readOnly:!0,derivedBy:["poolCount"],getter:function(t,n){return e.Number.format(this.getValue(n,"poolCount"),{thousandsSeparator:","})}},pendingCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},memberPendingCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},topicCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},groupPoolAddURL:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){return"/groups/"+this.getValue(e,"pathAlias")+"/pool/add/"}},dateCreated:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},defaultFn:function(t){return e.moment()},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},latestPhotoActivity:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},defaultFn:function(t){return e.moment()},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},latestDiscussionActivity:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},defaultFn:function(t){return e.moment()},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},showPoolToNonMembers:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},showDiscussionToNonMembers:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},eighteenplus:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},needsInterstitial:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},privacy:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},iconurls:{},bestIconURL:{readOnly:!0,derivedBy:["iconurls"],defaultFn:function(t){var n=e.URLHelper.getGroupIconURL(this.getValue(t,"iconurls"));return n?n:undefined}},url:{readOnly:!0,derivedBy:["group"
],defaultFn:function(e){return"/groups/"+(this.getValue(e,"pathAlias")||e)+"/"}},urlMembersPage:{readOnly:!0,derivedBy:["group","url"],defaultFn:function(e){return this.getValue(e,"url")+"members"}},urlPoolPage:{readOnly:!0,derivedBy:["group","url"],defaultFn:function(e){return this.getValue(e,"url")+"pool"}},urlDiscussionPage:{readOnly:!0,derivedBy:["group","url"],defaultFn:function(e){return this.getValue(e,"url")+"discuss"}},urlPendingMembersPage:{readOnly:!0,derivedBy:["id"],defaultFn:function(e){return"/groups_pending.gne?id="+e}},urlPendingPhotosPage:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){return"/groups/"+this.getValue(e,"pathAlias")+"/admin/pending"}},coverPhotoUrls:{},latestGroupActivity:{readOnly:!0,derivedBy:["latestPhotoActivity","latestDiscussionActivity","dateCreated"],defaultFn:function(t){var n=this.getValue(t,"latestDiscussionActivity"),r=this.getValue(t,"latestPhotoActivity"),i=this.getValue(t,"dateCreated"),s=i;return n.isValid()&&(s=e.moment.min(s,n)),r.isValid()&&(s=e.moment.min(s,r)),s}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","api-helper","url-helper","moment","flickr-groups-getInfo-fetcher","attribute-helpers"]});
YUI.add("photo-engagement-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)},update:e.PhotoModelHelper.updateEngagement},toggleFave:e.PhotoModelHelper.toggleFave,addAsFave:e.PhotoModelHelper.addAsFave,attributes:{ownerNsid:e.PhotoModelHelper.attributes.ownerNsid,isFaved:e.PhotoModelHelper.attributes.isFaved,faveCount:e.PhotoModelHelper.attributes.faveCount,commentCount:e.PhotoModelHelper.attributes.commentCount,canFave:e.PhotoModelHelper.attributes.canFave,canShare:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canDownload:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},noteCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},viewCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},isOwner:{readOnly:!0,derivedBy:["owner"],getter:function(e,t){var n=this.appContext.getViewer();return!!n.signedIn&&this.getValue(t,"ownerNsid")===n.nsid}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","photo-model-helper","flickr-photos-getInfo-fetcher","flickr-favorites-add-updater","flickr-favorites-remove-updater","attribute-helpers"]});
YUI.add("flickr-photos-setDates-updater",function(e){"use strict";function t(t,n){var r={};return t.fullResponse?(r.photo_ids=t.photoId,r.full_response=1):r.photo_id=t.photoId,t.datePosted&&(r.date_posted=t.datePosted),t.dateTaken&&(r.date_taken=t.dateTaken),t.takenGranularity>=0&&t.takenGranularity<=10&&(r.date_taken_granularity=t.takenGranularity),e.Promise.all([n.callAPI("flickr.photos.setDates",r),n.getModelRegistry("photo-stats-models")]).then(function(e){var r=e[0],i=e[1],s,o={};s=r.errors;if(t.fullResponse){if(s&&r.errors.length>0)return s}else{if(!i.exists(t.photoId))throw new Error("[flickr-photos-setDates-updater] - Photo-stats model can not be updated if it does not exist");(!r.photo||!r.photo.datePosted&&!r.photo.dateTaken)&&n.warn("[flickr-photos-setDates-updater] - No updated data returned from API."),r.photo?(r.photo.datePosted&&(o.datePosted=r.photo.datePosted.content),r.photo.dateTaken&&(o.dateTaken=r.photo.dateTaken.content,o.takenGranularity=r.photo.dateTakenGranularity.content)):(t.datePosted&&(o.datePosted=t.datePosted),t.dateTaken&&(o.dateTaken=t.dateTaken),t.takenGranularity&&(o.takenGranularity=t.takenGranularity)),Object.keys(o).length>0&&i.setValues(t.photoId,o)}},function(e){throw t.fullResponse?e.photoIds=t.photoId:n[e.fatal?"error":"debug"]("[flickr-photos-setDates-updater] failed getting or processing API response:",e),e})}e.namespace("ModelUpdaters")["flickr-photos-setDates"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("photo-stats-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)},update:function(t,n){var r={photoId:t},i=!0;return n.datePosted&&(r.datePosted=n.datePosted.newVal,i=!1),n.dateTaken&&(r.dateTaken=n.dateTaken.newVal,i=!1),n.takenGranularity&&(r.takenGranularity=n.takenGranularity.newVal,i=!1),i?e.Promise.resolve():e.ModelUpdaters["flickr-photos-setDates"].run(r,this.appContext)},batchUpdate:function(t,n){return"postedDate"in n&&"takenDate"in n?e.ModelUpdaters["flickr-photos-setDates"].run({photoId:t,datePosted:n.postedDate,dateTaken:n.takenDate,takenGranularity:n.takenGranularity,fullResponse:1},this.appContext):"postedDate"in n?e.ModelUpdaters["flickr-photos-setDates"].run({photoId:t,datePosted:n.postedDate,fullResponse:1},this.appContext):e.ModelUpdaters["flickr-photos-setDates"].run({photoId:t,dateTaken:n.takenDate,takenGranularity:n.takenGranularity,fullResponse:1},this.appContext)}},attributes:{dateTaken:{},datePosted:{},takenGranularity:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){t=e.AttributeHelpers.coerceInteger(t);if(t<0||t>10)t=undefined;return t},defaultValue:0},isDateTakenUnknown:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return t=e.AttributeHelpers.coerceBoolean(t),t},defaultValue:!1},isCirca:{readOnly:!0,derivedBy:["takenGranularity"],defaultFn:function(e){return this.getValue(e,"takenGranularity")===8}},isSometime:{readOnly:!0,derivedBy:["takenGranularity"],defaultFn:function(e){return this.getValue(e,"takenGranularity")===6}}},getDateObj:function(t,n){if(n!=="dateTaken"&&n!=="datePosted")throw new Error(this.intlMessage({intlName:"models.BAD_DATE_TYPE"}));var r={},i=this.getValue(t,n),s=this.getValue(t,"takenGranularity");return i?(n==="dateTaken"?s===8?r={granularity:s,year:i.replace(/^([\d]+)(.*)/g,"$1"),monthName:this.intlMessage({intlName:"common.CIRCA"})}:s===6?(i=e.moment(i),r={granularity:s,year:i.format("YYYY"),monthName:this.intlMessage({intlName:"common.SOMETIME_IN"})}):s===4?(i=e.moment(i),r={granularity:s,year:i.format("YYYY"),month:i.format("M"),monthName:i.format("MMMM")}):(i=e.moment(i),r={granularity:s,year:i.format("YYYY"),month:i.format("M"),monthName:i.format("MMMM"),day:i.format("D"),hour:i.format("HH"),minute:i.format("mm"),second:i.format("ss")}):(i=e.moment(i,"X"),r={granularity:s,year:i.format("YYYY"),month:i.format("M"),monthName:i.format("MMMM"),day:i.format("D"),hour:i.format("HH"),minute:i.format("mm"),second:i.format("ss")}),r):{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","attribute-helpers","flickr-photos-setDates-updater","moment"],langBundles:["models","common"]});
YUI.add("hermes-lang-models",function(e,t){e.Intl.add("hermes/models","en-US",{YOUR_PHOTOSTREAM:["Your photostream"],USER_PHOTOSTREAM:["${name}","'s photostream"],PHOTOSTREAM:["Photostream"],ZERO_PHOTOS:["0 photos"],ONE_PHOTO:["1 photo"],MULTIPLE_PHOTOS:["${photos}"," photos"],ONE_VIDEO:["1 video"],ONE_PHOTO_AND_ONE_VIDEO:["1 photo and 1 video"],MULTIPLE_PHOTOS_AND_ONE_VIDEO:["${photos}"," photos and 1 video"],MULTIPLE_VIDEOS:["${videos}"," videos"],ONE_PHOTO_AND_MULTIPLE_VIDEOS:["1 photo and ","${videos}"," videos"],MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS:["${photos}"," photos and ","${videos}"," videos"],PHOTO_LIST:["Photo list"],EXPlORE_TITLE:["Explore ","${id}"],BAD_DATE_TYPE:["Bad date type"],ZERO_ITEMS:["0 items"],ONE_ITEM:["1 item"],MULTIPLE_ITEMS:["${items}"," items"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-common",function(e,t){e.Intl.add("hermes/common","en-US",{SIGN_UP:["Sign Up"],YOU:["You"],PHOTOSTREAM:["Photostream"],SETS:["Sets"],ALBUMS:["Albums"],MAP:["Map"],FAVORITES:["Favorites"],GALLERIES:["Galleries"],COLLECTIONS:["Collections"],ARCHIVES:["Archives"],TAGS:["Tags"],PHOTOS_OF:["Photos of"],PROFILE:["Profile"],POPULAR:["Popular"],EXPLORE:["Explore"],ACTIVITY:["Recent activity"],STATS:["Stats"],ORGANIZE:["Organize"],HELP:["Help"],SETTINGS:["Settings"],SIGN_OUT:["Sign Out"],FLICKRMAIL:["FlickrMail"],ERROR:["Error"],OK:["OK"],OOPS:["Oops!"],SIGN_IN:["Sign in"],FORGET_IT:["Forget it"],WARNING:["Warning"],DONE:["Done"],ZOINKS:["Zoinks!"],CANCEL:["Cancel"],ON:["On"],OFF:["Off"],ABOUT:["About"],JOBS:["Jobs"],BLOG:["Blog"],APPS:["Apps"],BRAND:["Brand"],DEVELOPERS:["Developers"],STATUS:["Status"],COMMUNITY_GUIDELINES:["Community guidelines"],REPORT_ABUSE:["Report abuse"],PRIVACY:["Privacy"],TERMS:["Terms"],YAHOO_SAFELY:["Yahoo Safely"],FEEDBACK:["Feedback"],MOBILE:["Mobile"],APP_GARDEN:["App Garden"],COMMUNITY:["Community"],API_DOC:["API Doc"],DEVELOPER_GUIDE:["Developer Guide"],DEVELOPER_BLOG:["Developer Blog"],HELP_FORUM:["Help forum"],GUIDELINES:["Guidelines"],NUMBER:[{type:"number",valueName:"num"}],RETRY:["Retry"],EDIT:["Edit"],MORE:["More"],DELETE:["Delete"],LOADING:["Loading"],FOLLOW:["Follow"],FOLLOWING:["Following"],UNFOLLOW:["Unfollow"],FRIEND:["Friend"],FAMILY:["Family"],A_YAHOO_COMPANY:["Flickr, a Yahoo company"],A_YAHOO_COMPANY_WITH_LINK:['Flickr, <a href="https://info.yahoo.com">a Yahoo company</a>'],CONFIRMATION:["Confirmation"],FAVORITE:["Favorite"],SEARCH:["Search"],CONFIRM:["Confirm"],SELECT:["Select"],NEW:["New"],LOADING_WITH_ELLIPSES:["Loading..."],NONE:["None"],TITLE:["Title"],DESCRIPTION:["Description"],DECLINE:["Decline"],ACCEPT:["Accept"],CIRCA:["Circa"],SOMETIME_IN:["Sometime in..."],JANUARY:["January"],FEBRUARY:["February"],MARCH:["March"],APRIL:["April"],MAY:["May"],JUNE:["June"],JULY:["July"],AUGUST:["August"],SEPTEMBER:["September"],OCTOBER:["October"],NOVEMBER:["November"],DECEMBER:["December"],SAVE:["Save"],PLEASE_TRY_AGAIN:["Please try again"],YES:["Yes"],SQUARE:["Square"],THUMBNAIL:["Thumbnail"],SMALL:["Small"],MEDIUM:["Medium"],LARGE:["Large"],ORIGINAL:["Original"],REPLACE:["Replace"],SAVING:["Saving"],REPLACING:["Replacing"],JOIN:["Join"],SELECTED:["selected"],PREVIEW:["Preview"],DATE_TAKEN:["Date Taken"],DATE_POSTED:["Date Posted"],PEOPLE:["People"],BETA:["Beta"],INVALID_DATE:["Invalid Date."],INVALID_DATE_TAKEN:["Invalid Date Taken."],INVALID_DATE_POSTED:["Invalid Date Posted."],FUTURE_DATE_POSTED:["Date Posted is set to the future."],INVALID_DATE_VALUE:["One or more of the dates you entered was invalid."],INVALID_DATE_TAKEN_VALUE:["Date Taken value is invalid."],INVALID_DATE_POSTED_VALUE:["Date Posted value is invalid."],DOWNLOAD:["Download"],CHOOSE_VALID_DATE:["Please choose a valid date."],FUTURE_DATE_TAKEN:["Date Taken is set to the future."],BY_USER:["by ","${user}"]})},"@VERSION@",{requires:["intl"]});
YUI.add("flickr-groups-pools-getContext-fetcher",function(e){"use strict";function t(t){var n={photo_id:t.photoId,extras:e.APIHelper.request.getRebootPhotoExtras()+",datecreate",num_prev:t.numNext,num_next:t.numPrev,get_group_info:1};if(t.id)n.group_id=t.id;else{if(!t.pathAlias)throw new Error("[flickr-groups-pools-getPhotos-fetcher] `id` or `pathAlias` is required.");n.group_path_alias=t.pathAlias}return n}function n(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=[],l=[],c=s.proxy(n.photoId),h,p,d,v,m,g,y=[];return h=r.prevphotos,p=r.nextphotos,l=e.APIHelper.response.parsePhotos({photos:h.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),f=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),g=i.getValue(n.id,"photoContextList"),v=g.hasMinBoundary?g.hasMinBoundary():!1,m=g.hasMaxBoundary?g.hasMaxBoundary():!1,d=g.getList(),y=e.APIHelper.response.addOrReplaceListByContext({model:c,next:l,prev:f.reverse(),current:d,hasMin:v,hasMax:m,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",y),{next:l,previous:f.reverse()}}function r(t,n){var r=this;return e.Promise.all([n.callAPI("flickr.groups.pools.getContext",this._processParams(t),!0),n.getModelRegistry("group-pool-models"),n.getModelRegistry("photo-models"),n.getModelRegistry("person-models"),n.getModelRegistry("photo-engagement-models"),n.getModelRegistry("photo-stats-models")]).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-groups-pools-getContext-fetcher] failed getting or processing API response:",e),e.code===2&&e.message==="Photo not in pool"&&(e.notInContext=!0),e})}e.namespace("ListFetchers")["flickr-groups-pools-getContext"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","photo-engagement-models","photo-stats-models","group-models"]});
YUI.add("flickr-groups-pools-add-creator",function(e){"use strict";function t(t){var n={photo_id:t.photoID,group_id:e.Models["group-pool-models"].extractGroupFromCompoundId(t.groupID)};return n}function n(e,t){var n=e.apiResponse,r=e.groupPoolModel,i=e.photoModel,s=e.photoGroupsModelRegistry,o=e.photoContextsModelRegistry,u=e.unfilteredGroupPoolModel;if(n.stat==="ok")return r&&!r.hasPhoto(i.getValue("id"))&&(r.addPhotoLocal(i),r.getValue("group").setValue("poolCount",r.getValue("group").getValue("poolCount")+1)),u&&u.hasPhoto(i.getValue("id"))&&u.addPhotoLocal(i),s.exists(t.photoID)&&!s.getValue(t.photoID,"groups").getFromListByID(t.unfilteredGroupId)&&(s.getValue(t.photoID,"groups").prependToList(r),s.setValue(t.photoID,"total",s.getValue(t.photoID,"total")+1)),o.exists(t.photoID)&&!o.getValue(t.photoID,"contexts").getFromListByID(t.unfilteredGroupId)&&(o.setValue(t.photoID,"totalGroups",o.getValue(t.photoID,"totalGroups")+1),o.getValue(t.photoID,"contexts").appendToList(r)),r}function r(t,n){var r=this,i=this._processParams(t),s=t.registryName||"group-pool-models",o={apiResponse:n.callAPI("flickr.groups.pools.add",i),groupPoolModel:n.getModel(s,t.groupID),photoModel:n.getModel("photo-models",t.photoID),photoGroupsModelRegistry:n.getModelRegistry("photo-groups-models"),photoContextsModelRegistry:n.getModelRegistry("photo-contexts-models")};return t.unfilteredGroupId=i.group_id,s!=="group-pool-models"&&(o.unfilteredGroupPoolModel=n.getModel("group-pool-models",t.unfilteredGroupId)),(new e.FlickrPromise(o)).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-groups-pools-add-creator] failed getting or processing API response:",e),e})}e.namespace("ModelCreators")["flickr-groups-pools-add"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","group-pool-models"],optional:[]});
YUI.add("flickr-groups-pools-remove-deletor",function(e){"use strict";function t(t){var n={photo_id:t.photoID,group_id:e.Models["group-pool-models"].extractGroupFromCompoundId(t.groupID)};return n}function n(e,t){var n=e.apiResponse,r=e.groupPoolModelRegistry,i=e.photoModelRegistry,s=e.photoGroupsModelRegistry,o=e.photoContextsModelRegistry,u=e.unfilteredGroupPoolModelRegistry;if(n.stat==="ok")return o.exists(t.photoID)&&o.getValue(t.photoID,"contexts").getFromListByID(t.unfilteredGroupId)&&(o.setValue(t.photoID,"totalGroups",o.getValue(t.photoID,"totalGroups")-1),o.getValue(t.photoID,"contexts").removeFromList(t.unfilteredGroupId)),s.exists(t.photoID)&&s.getValue(t.photoID,"groups").getFromListByID(t.unfilteredGroupId)&&(s.setValue(t.photoID,"total",s.getValue(t.photoID,"total")-1),s.getValue(t.photoID,"groups").removeFromList(t.unfilteredGroupId)),r&&(r.hasPhoto(i.getValue("id"))&&r.removePhotoLocal(i),r.getValue("group").setValue("poolCount",r.getValue("group").getValue("poolCount")-1)),u&&u.hasPhoto(i.getValue("id"))&&u.removePhotoLocal(i),r}function r(t,n){var r=this,i=this._processParams(t),s=t.registryName||"group-pool-models",o={apiResponse:n.callAPI("flickr.groups.pools.remove",i),groupPoolModelRegistry:n.getModel(s,t.groupID),photoModelRegistry:n.getModel("photo-models",t.photoID),photoGroupsModelRegistry:n.getModelRegistry("photo-groups-models"),photoContextsModelRegistry:n.getModelRegistry("photo-contexts-models")};return t.unfilteredGroupId=i.group_id,s!=="group-pool-models"&&(o.unfilteredGroupPoolModelRegistry=n.getModel("group-pool-models",t.unfilteredGroupId)),(new e.FlickrPromise(o)).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-groups-pools-remove-deletor] failed getting or processing API response:",e),e})}e.namespace("ModelDeletors")["flickr-groups-pools-remove"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","group-pool-models"],optional:[]});
YUI.add("flickr-groups-invite-photo-invite-creator",function(e){"use strict";function t(t,n){var r={},i=e.Models["group-pool-models"].extractGroupFromCompoundId(t.groupID);return r.photo_id=t.photoID,r.group_id=i,e.Promise.all([n.callAPI("flickr.groups.invite.photo.invite",r),n.getModel("group-pool-models",i),n.getModelRegistry("photo-group-invitation-models"),n.getModelRegistry("photo-group-invitations-models")]).then(function(e){var r=e[0],s=e[1],o=e[2],u=e[3],a,f,l;if(r.stat==="ok")return a=[t.photoID,i].join("-"),f={id:a,photoId:t.photoID,groupId:i,invitedBy:n.getViewer().nsid},l=o.exists(a)?o.proxy(a):o.add(f),u.exists(t.photoID)&&!u.getValue(t.photoID,"invitations").getFromListByID(a)&&(u.getValue(t.photoID,"groups").prependToList(s),u.getValue(t.photoID,"invitations").prependToList(l),u.setValue(t.photoID,"total",u.getValue(t.photoID,"total")+1)),s},function(e){throw n[e.fatal?"error":"debug"]("[flickr-groups-invite-photo-invite] failed getting or processing API response:",e),e})}e.namespace("ModelCreators")["flickr-groups-invite-photo-invite"]={run:t}},"@VERSION@",{requires:["flickr-promise","group-pool-models"],optional:[]});
YUI.add("flickr-groups-invite-photo-cancel-deletor",function(e){"use strict";function t(t,n){var r={},i=e.Models["group-pool-models"].extractGroupFromCompoundId(t.groupID);return r.photo_id=t.photoID,r.group_id=i,e.Promise.all([n.callAPI("flickr.groups.invite.photo.cancel",r),n.getModel("group-pool-models",i),n.getModelRegistry("photo-group-invitation-models"),n.getModelRegistry("photo-group-invitations-models")]).then(function(e){var n=e[0],r=e[1],s=e[2],o=e[3],u;if(n.stat==="ok")return u=[t.photoID,i].join("-"),o.exists(t.photoID)&&o.getValue(t.photoID,"invitations").getFromListByID(u)&&(o.setValue(t.photoID,"total",o.getValue(t.photoID,"total")-1),o.getValue(t.photoID,"groups").removeFromList(i),o.getValue(t.photoID,"invitations").removeFromList(u)),s.remove(u),r},function(e){throw n[e.fatal?"error":"debug"]("[flickr-groups-invite-photo-cancel] failed getting or processing API response:",e),e})}e.namespace("ModelDeletors")["flickr-groups-invite-photo-cancel"]={run:t}},"@VERSION@",{requires:["flickr-promise","group-pool-models"],optional:[]});
YUI.add("group-pool-by-person-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.Models["group-pool-models"],{name:this.name,attributes:e.merge(e.Models["group-pool-models"].prototype.attributes,{personFilter:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:null}})})},"@VERSION@",{requires:["attribute-helpers","group-pool-models","flickr-groups-pools-getPhotos-fetcher","flickr-groups-pools-add-creator","flickr-groups-pools-remove-deletor","flickr-groups-invite-photo-invite-creator","flickr-groups-invite-photo-cancel-deletor"]});
YUI.add("group-pool-by-tag-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.Models["group-pool-models"],{name:this.name,attributes:{tagFilter:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:null}}})},"@VERSION@",{requires:["attribute-helpers"]});
